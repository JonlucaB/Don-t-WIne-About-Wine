{"ast":null,"code":"var internals = require('../internals'),\n    Vec2D = require('../geom/Vec2D');\n\nvar VerletParticle2D = function (x, y, w) {\n  this.force = new Vec2D();\n\n  if (internals.has.XY(x)) {\n    if (internals.is.VerletParticle2D(x)) {\n      y = x.y;\n      w = x.weight;\n      x = x.x;\n      this.isLocked = x.isLocked;\n    } else if (y === undefined) {\n      y = x.y;\n      w = 1;\n      x = x.x;\n    } else {\n      w = y;\n      y = x.y;\n      x = x.x;\n    }\n  }\n\n  Vec2D.call(this, x, y);\n  this.isLocked = false;\n  this.prev = new Vec2D(this);\n  this.temp = new Vec2D();\n  w = w || 1;\n  this.setWeight(w);\n};\n\ninternals.extend(VerletParticle2D, Vec2D);\n\nVerletParticle2D.prototype.addBehavior = function (behavior, timeStep) {\n  if (this.behaviors === undefined) {\n    this.behaviors = [];\n  }\n\n  if (behavior === undefined) {\n    throw new Error(\"behavior was undefined\");\n  }\n\n  timeStep = timeStep === undefined ? 1 : timeStep;\n  behavior.configure(timeStep);\n  this.behaviors.push(behavior);\n  return this;\n};\n\nVerletParticle2D.prototype.addConstraint = function (c) {\n  if (this.constraints === undefined) {\n    this.constraints = [];\n  }\n\n  this.constraints.push(c);\n  return this;\n};\n\nVerletParticle2D.prototype.addForce = function (f) {\n  this.force.addSelf(f);\n  return this;\n};\n\nVerletParticle2D.prototype.addVelocity = function (v) {\n  this.prev.subSelf(v);\n  return this;\n};\n\nVerletParticle2D.prototype.applyBehaviors = function () {\n  if (this.behaviors !== undefined) {\n    var i = 0,\n        len = this.behaviors.length;\n\n    for (i = 0; i < len; i++) {\n      this.behaviors[i].applyBehavior(this);\n    }\n  }\n};\n\nVerletParticle2D.prototype.applyConstraints = function () {\n  if (this.constraints !== undefined) {\n    var i = 0,\n        len = this.constraints.length;\n\n    for (i = 0; i < len; i++) {\n      this.constraints[i].applyConstraint(this);\n    }\n  }\n};\n\nVerletParticle2D.prototype.clearForce = function () {\n  this.force.clear();\n  return this;\n};\n\nVerletParticle2D.prototype.clearVelocity = function () {\n  this.prev.set(this);\n  return this;\n};\n\nVerletParticle2D.prototype.getInvWeight = function () {\n  return this.invWeight;\n};\n\nVerletParticle2D.prototype.getPreviousPosition = function () {\n  return this.prev;\n};\n\nVerletParticle2D.prototype.getVelocity = function () {\n  return this.sub(this.prev);\n};\n\nVerletParticle2D.prototype.getWeight = function () {\n  return this.weight;\n};\n\nVerletParticle2D.prototype.lock = function () {\n  this.isLocked = true;\n  return this;\n};\n\nVerletParticle2D.prototype.removeAllBehaviors = function () {\n  this.behaviors = [];\n  return this;\n};\n\nVerletParticle2D.prototype.removeAllConstraints = function () {\n  this.constraints = [];\n  return this;\n};\n\nVerletParticle2D.prototype.removeBehavior = function (b) {\n  return internals.removeItemFrom(b, this.behaviors);\n};\n\nVerletParticle2D.prototype.removeConstraint = function (c) {\n  return internals.removeItemFrom(c, this.constraints);\n};\n\nVerletParticle2D.prototype.scaleVelocity = function (scl) {\n  this.prev.interpolateToSelf(this, 1 - scl);\n  return this;\n};\n\nVerletParticle2D.prototype.setPreviousPosition = function (p) {\n  this.prev.set(p);\n  return this;\n};\n\nVerletParticle2D.prototype.setWeight = function (w) {\n  this.weight = w;\n  this.invWeight = w !== 0 ? 1 / w : 0; //avoid divide by zero\n};\n\nVerletParticle2D.prototype.unlock = function () {\n  this.clearVelocity();\n  this.isLocked = false;\n  return this;\n};\n\nVerletParticle2D.prototype.update = function () {\n  if (!this.isLocked) {\n    this.applyBehaviors(); //applyForce() - inline\n\n    this.temp.set(this);\n    this.addSelf(this.sub(this.prev).addSelf(this.force.scale(this.weight)));\n    this.prev.set(this.temp);\n    this.force.clear(); //\n\n    this.applyConstraints();\n  }\n};\n\nmodule.exports = VerletParticle2D;","map":{"version":3,"sources":["C:/Users/alfor/Documents/GitHub/Don-t-WIne-About-Wine/node_modules/toxiclibsjs/physics2d/VerletParticle2D.js"],"names":["internals","require","Vec2D","VerletParticle2D","x","y","w","force","has","XY","is","weight","isLocked","undefined","call","prev","temp","setWeight","extend","prototype","addBehavior","behavior","timeStep","behaviors","Error","configure","push","addConstraint","c","constraints","addForce","f","addSelf","addVelocity","v","subSelf","applyBehaviors","i","len","length","applyBehavior","applyConstraints","applyConstraint","clearForce","clear","clearVelocity","set","getInvWeight","invWeight","getPreviousPosition","getVelocity","sub","getWeight","lock","removeAllBehaviors","removeAllConstraints","removeBehavior","b","removeItemFrom","removeConstraint","scaleVelocity","scl","interpolateToSelf","setPreviousPosition","p","unlock","update","scale","module","exports"],"mappings":"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","sourcesContent":["\n\nvar internals = require('../internals'),\n\tVec2D = require('../geom/Vec2D');\n\nvar\tVerletParticle2D = function(x,y,w){\n\tthis.force = new Vec2D();\n\tif( internals.has.XY( x ) ){\n\t\tif( internals.is.VerletParticle2D( x ) ){\n\n\t\t\ty = x.y;\n\t\t\tw = x.weight;\n\t\t\tx = x.x;\n\t\t\tthis.isLocked = x.isLocked;\n\n\t\t} else if(y === undefined){\n\t\t\ty = x.y;\n\t\t\tw = 1;\n\t\t\tx = x.x;\n\t\t} else {\n\t\t\tw = y;\n\t\t\ty = x.y;\n\t\t\tx = x.x;\n\t\t}\n\t}\n\tVec2D.call(this, x,y);\n\tthis.isLocked = false;\n\tthis.prev = new Vec2D(this);\n\tthis.temp = new Vec2D();\n\tw = w || 1;\n\tthis.setWeight(w);\n};\n\ninternals.extend(VerletParticle2D,Vec2D);\n\nVerletParticle2D.prototype.addBehavior = function(behavior,timeStep){\n\tif(this.behaviors === undefined){\n\t\tthis.behaviors = [];\n\t}\n\tif(behavior === undefined){\n\t\tthrow new Error(\"behavior was undefined\");\n\t}\n\ttimeStep = (timeStep === undefined)? 1 : timeStep;\n\tbehavior.configure(timeStep);\n\tthis.behaviors.push(behavior);\n\treturn this;\n};\n\nVerletParticle2D.prototype.addConstraint = function(c){\n\tif(this.constraints === undefined){\n\t\tthis.constraints = [];\n\t}\n\tthis.constraints.push(c);\n\treturn this;\n};\n\nVerletParticle2D.prototype.addForce = function(f){\n\tthis.force.addSelf(f);\n\treturn this;\n};\n\nVerletParticle2D.prototype.addVelocity = function(v){\n\tthis.prev.subSelf(v);\n\treturn this;\n};\n\nVerletParticle2D.prototype.applyBehaviors = function(){\n\tif(this.behaviors !== undefined){\n\t\tvar i = 0, len = this.behaviors.length;\n\t\tfor(i = 0;i<len;i++){\n\t\t\tthis.behaviors[i].applyBehavior(this);\n\t\t}\n\t}\n};\n\nVerletParticle2D.prototype.applyConstraints = function(){\n\tif(this.constraints !== undefined){\n\t\tvar i = 0, len = this.constraints.length;\n\t\tfor(i =0;i<len;i++){\n\t\t\tthis.constraints[i].applyConstraint(this);\n\t\t}\n\t}\n};\n\n\nVerletParticle2D.prototype.clearForce = function(){\n\tthis.force.clear();\n\treturn this;\n};\n\nVerletParticle2D.prototype.clearVelocity = function(){\n\tthis.prev.set(this);\n\treturn this;\n};\n\nVerletParticle2D.prototype.getInvWeight = function(){\n\treturn this.invWeight;\n};\n\nVerletParticle2D.prototype.getPreviousPosition = function(){\n\treturn this.prev;\n};\n\nVerletParticle2D.prototype.getVelocity = function(){\n\treturn this.sub(this.prev);\n};\n\nVerletParticle2D.prototype.getWeight = function(){\n\treturn this.weight;\n};\n\nVerletParticle2D.prototype.lock = function(){\n\tthis.isLocked = true;\n\treturn this;\n};\n\nVerletParticle2D.prototype.removeAllBehaviors = function(){\n\tthis.behaviors = [];\n\treturn this;\n};\n\nVerletParticle2D.prototype.removeAllConstraints = function(){\n\tthis.constraints = [];\n\treturn this;\n};\n\nVerletParticle2D.prototype.removeBehavior = function(b){\n\treturn internals.removeItemFrom(b,this.behaviors);\n};\n\nVerletParticle2D.prototype.removeConstraint = function(c){\n\treturn internals.removeItemFrom(c,this.constraints);\n};\n\nVerletParticle2D.prototype.scaleVelocity = function(scl){\n\tthis.prev.interpolateToSelf(this,1 - scl);\n\treturn this;\n};\n\nVerletParticle2D.prototype.setPreviousPosition = function(p){\n\tthis.prev.set(p);\n\treturn this;\n};\n\nVerletParticle2D.prototype.setWeight = function(w){\n\tthis.weight = w;\n\tthis.invWeight = (w !== 0) ? 1 / w : 0; //avoid divide by zero\n};\n\nVerletParticle2D.prototype.unlock = function() {\n\tthis.clearVelocity();\n\tthis.isLocked = false;\n\treturn this;\n};\n\nVerletParticle2D.prototype.update = function(){\n\n\tif(!this.isLocked){\n\t\tthis.applyBehaviors();\n\t\t//applyForce() - inline\n        this.temp.set(this);\n        this.addSelf(this.sub(this.prev).addSelf(this.force.scale(this.weight)));\n        this.prev.set(this.temp);\n        this.force.clear();\n        //\n\t\tthis.applyConstraints();\n\t}\n};\n\nmodule.exports = VerletParticle2D;\n\n"]},"metadata":{},"sourceType":"script"}